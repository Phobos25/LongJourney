# Запросы на создание таблицы 3

создаем таблицу ```fine``` со следующей структурой:


|Поле |	Описание|
|:--- | :---    |
|fine_id| 	ключевой столбец целого типа с автоматическим увеличением значения ключа на 1|
|name| 	строка длиной 30|
|number_plate| 	строка длиной 6|
|violation| 	строка длиной 50|
|sum_fine| 	вещественное число, максимальная длина 8, количество знаков после запятой 2|
|date_violation| 	дата|
|date_payment| 	дата|


CREATE TABLE fine
(
    fine_id        INT PRIMARY KEY AUTO_INCREMENT,
    name           VARCHAR(30),
    number_plate   VARCHAR(6),
    violation      VARCHAR(50),
    sum_fine       DECIMAL(8, 2),
    date_violation DATE,
    date_payment   DATE
);


## Задание

В таблицу fine первые 5 строк уже занесены. Добавить в таблицу записи с ключевыми значениями 6, 7, 8.
сначала занесем первые 5 строк:
```SQL
INSERT INTO fine (name, number_plate, violation, sum_fine, date_violation, date_payment)
VALUES ('Баранов П.Е.', 'P523BT', 'Превышение скорости(от 40 до 60)', NULL, '2020-02-14 ', NULL),
       ('Абрамова К.А.', 'О111AB', 'Проезд на запрещающий сигнал', NULL, '2020-02-23', NULL),
       ('Яковлев Г.Р.', 'T330TT', 'Проезд на запрещающий сигнал', NULL, '2020-03-03', NULL),
       ('Баранов П.Е.', 'P523BT', 'Превышение скорости(от 40 до 60)', 500.00, '2020-01-12', '2020-01-17'),
       ('Абрамова К.А.', 'О111AB', 'Проезд на запрещающий сигнал', 1000.00, '2020-01-14', '2020-02-27'),
       ('Яковлев Г.Р.', 'T330TT', 'Превышение скорости(от 20 до 40)', 500.00, '2020-01-23', '2020-02-23'),
       ('Яковлев Г.Р.', 'M701AA', 'Превышение скорости(от 20 до 40)', NULL, '2020-01-12', NULL),
       ('Колесов С.П.', 'K892AX', 'Превышение скорости(от 20 до 40)', NULL, '2020-02-01', NULL);
```

**Запрос**
```SQL
INSERT INTO fine(NAME, number_plate, violation, sum_fine, date_violation, date_payment)
VALUES ('Баранов П.Е.', 'Р523ВТ','Превышение скорости(от 40 до 60)', NULL, '2020-02-14', NULL),
       ('Абрамова К.А.','О111АВ','Проезд на запрещающий сигнал',     NULL, '2020-02-23', NULL),
       ('Яковлев Г.Р.', 'Т330ТТ','Проезд на запрещающий сигнал',     NULL, '2020-03-03', NULL);
```

## Задание
Водители оплачивают свои штрафы. В таблице ```payment``` занесены даты их оплаты:

|payment_id| 	name| 	number_plate| 	violation| 	date_violation| 	date_payment|
|:---|:---|:---|:---|:---|:---|   
|1 	|Яковлев Г.Р.| 	М701АА| 	Превышение скорости (от 20 до 40) |	2020-01-12|	2020-01-22|
|2 	|Баранов П.Е.| 	Р523ВТ| 	Превышение скорости (от 40 до 60) |	2020-02-14 |	2020-03-06|
|3 |	Яковлев Г.Р.| 	Т330ТТ| 	Проезд на запрещающий сигнал| 	2020-03-03| 	2020-03-23|

Необходимо:

* в таблицу fine занести дату оплаты соответствующего штрафа из таблицы payment; 
* уменьшить начисленный штраф в таблице fine в два раза  (только для тех штрафов, информация о которых занесена в таблицу payment) , если оплата произведена не позднее 20 дней со дня нарушения.

```SQL
UPDATE fine AS f, payment AS p
   SET f.sum_fine = IF (DATEDIFF(p.date_payment, p.date_violation)<=20, f.sum_fine/2, f.sum_fine),
       f.date_payment = p.date_payment
 WHERE (f.date_payment IS Null)    AND
       (f.violation = p.violation) AND
       (f.number_plate = p.number_plate);
```
**Результат**
```
Query result:
+---------------+--------------+----------------------------------+----------+--------------+
| name          | number_plate | violation                        | sum_fine | date_payment |
+---------------+--------------+----------------------------------+----------+--------------+
| Баранов П.Е.  | Р523ВТ       | Превышение скорости(от 40 до 60) | 500.00   | 2020-01-17   |
| Абрамова К.А. | О111АВ       | Проезд на запрещающий сигнал     | 1000.00  | 2020-02-27   |
| Яковлев Г.Р.  | Т330ТТ       | Превышение скорости(от 20 до 40) | 500.00   | 2020-02-23   |
| Яковлев Г.Р.  | М701АА       | Превышение скорости(от 20 до 40) | 250.00   | 2020-01-22   |
| Колесов С.П.  | К892АХ       | Превышение скорости(от 20 до 40) | 500.00   | NULL         |
| Баранов П.Е.  | Р523ВТ       | Превышение скорости(от 40 до 60) | 2000.00  | 2020-03-06   |
| Абрамова К.А. | О111АВ       | Проезд на запрещающий сигнал     | 2000.00  | NULL         |
| Яковлев Г.Р.  | Т330ТТ       | Проезд на запрещающий сигнал     | 500.00   | 2020-03-23   |
+---------------+--------------+----------------------------------+----------+--------------+
```


## Задание

Удалить из таблицы fine информацию о нарушениях, совершенных раньше 1 февраля 2020 года. 

```SQL
DELETE FROM fine
 WHERE DATEDIFF('2020-02-01',date_violation) > 0;
```
