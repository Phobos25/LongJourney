# Задание

В таблице city для каждого города указано количество дней, за которые заказ может быть доставлен в этот город (рассматривается только этап Транспортировка). Для тех заказов, которые прошли этап транспортировки, вывести количество дней за которое заказ реально доставлен в город. А также, если заказ доставлен с опозданием, указать количество дней задержки, в противном случае вывести 0. В результат включить номер заказа (buy_id), а также вычисляемые столбцы Количество_дней и Опоздание. Информацию вывести в отсортированном по номеру заказа виде.


    Для вычисления поля «Опоздание» используйте функцию if(), а для вычисления разности дат – функцию DATEDIFF().
    Если доставка еще не осуществлена, то поле date_step_end  для этапа Транспортировка - пусто.


 **Запрос**

 ```SQL
SELECT buy.buy_id,
       DATEDIFF(date_step_end, date_step_beg) AS Количество_дней,
       GREATEST (DATEDIFF(date_step_end, date_step_beg) - city.days_delivery, 0) AS Опоздание
  FROM 
       city
       INNER JOIN client   ON city.city_id = client.city_id
       INNER JOIN buy      ON client.client_id = buy.client_id
       INNER JOIN buy_step ON buy.buy_id = buy_step.buy_id
       INNER JOIN step     ON buy_step.step_id = step.step_id
 WHERE (step.step_id = 3) AND (buy_step.date_step_end IS NOT NULL)

 ```

 *Результат*

 ```
 Query result:
+--------+-----------------+-----------+
| buy_id | Количество_дней | Опоздание |
+--------+-----------------+-----------+
| 1      | 14              | 2         |
| 3      | 4               | 0         |
+--------+-----------------+-----------+
Affected rows: 2
 ```