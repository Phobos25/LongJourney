# методы поиска ассоциативных правил 

## Определения и обозначения

см. рисунок

ассоциативное правило (association rule) - это пара непересекающихся наборов таких, что 
1) наборы $$\phi$$ и y совместно часто встречаются,
$$\nu(\phi \cap y)\geq \delta$$

2) если встречаются $$\phi$$, то часто встречаются также y
$$\nu(y|\phi)\equiv \frac{\nu(\phi\hat y)}{\nu(\phi)}\geq \kappa$$

где $$\nu(y|\phi)$$ - значимость (confidence) правила
* Параметр $$\delta$$ - минимальная поддержка, MinSupp
* Параметр $$\kappa$$ - минимальая значимость, MinConf

Задача сводится к тому, чтобы найти как можно больше ассоциативных правил, которые удовлетворяют этим двум методам

## классический пример
Это делалось в 90-е годы, для data mining (для выкапывания данных) из БД супермаркетов, которые там накопились. Цель заключалась в том, чтобы оптимизировать расстановку продуктов для увеличения продаж. 

**Анализ рыночных корзин (market basket analysis) [1993]**
признаки - товары (предметы, items)
объекты - чеки (транзакции)

$$f_{j}(x_{i}) = 1$$ в i-м чеке зафиксирована покупка j-го товара

Пример 1: "если куплен хлеб $$\phi$$, то будет куплено и молоко y  с вероятностью $$\nu(y|\phi)$$=60%; причём оба товара покупаются совместно с вероятностью $$\nu(\phi\cup y)$$=2%"

Цели анализа:
* оптимизировать размещение товаров на полках;
* формировать персональные рекомендации;
* планировать рекламные кампании (промо-акции);
* более эффективно управлять ценами и ассортиментом.


Пример 2: **Выявление тематики в коллекциях текстовых документов**

признаки - термины (отдельные слова или выражения)
объекты - текстовые документы

$$f_{j}(x_{i})=1$$ - в i-м тексте (часто) употребляется j-й термин.

Тема - это совокупность терминов, совместно встречающихся в узком подмножестве документов, то есть частый набор. 

**Недостаток:** слишком жесткое требование, чтобы в тексте встречались все слова темы. Вероятностные модели адекватнее.

**Цели анализа:**

* получение признаков для выделения терминов;
* выделение наиболее четких тем;
* формирование начальных приближений для Topic Models. 

## Два этапа построения правил. Свойство антимонотонности

Поскольку $$\phi(x)=\bigwedge_{f\in \phi} f(x)$$ - конъюнкция, имеет место

Свойство антимонотонности:

для любых $$\psi, \phi \subset F$$ из $$\phi \subset \psi$$ следует $$\nu(\phi)\geq \nu(\psi)$$

Следствия:
1) если $$\psi$$ частый, то все его подмножества $$\phi \subset \psi$$ частые.
2) если $$\phi$$ не частый, то все наборы $$\psi \supset \phi$$ также не частые. 
3) $$\nu(\phi \cup \psi)\leq \nu(\phi)$$ для любых $$\phi, \psi$$

Два этапа поиска ассоциативных правил:
1) поиск частых наборов (многократный просмотр транзакционной базы данных)
2) выделение ассоциативных правил (простая эффективная процедура в оперативной памяти)

## Алгоритм APriory (основная идея - поиск в ширину)

**Вход:** $$X^{l}$$ - обучающая выборка; минимальная поддержка $$\delta$$; минимальная значимость $$\kappa$$;
**Выход:** R={($$\phi$$, y)} - список ассоциативных правил;

1) множество всех частых исходных принаков:
$$G_{1}:=$${$$f\in F|\nu(f)\geq \delta$$};
2) для всех j=2,...,n
3) множество всех частых наборов мощности j:
$$G_{j}$$:= {$$\phi \cup$${f}|$$\phi\in G_{j-1}, f\in G_{1}/\phi$$,$$\nu(\phi\cap)$${f}$$\geq$$\delta};
4) если $$G_{j}=\varnothing$$ то
5) выход из цикла по j;
6) R:=$$\varnothing$$;
7) для всех $$\psi\in G_{j}$$, j=2,...,n
8) AssocRules (R, $$\psi, \varnothing$$)


29:50










